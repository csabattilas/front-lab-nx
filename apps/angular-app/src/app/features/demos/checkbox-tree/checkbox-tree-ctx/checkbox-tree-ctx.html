<h2>Checkbox tree (ctx) form-control</h2>
<fl-lion-tabs persist-selected-index-to="checkbox-tree-ctx">
  <button slot="tab">Overview</button>
  <section slot="panel">
    <h3 class="mt-3 mb-6">Overview</h3>
    <p class="mb-6">
      The <code>fl-form-checkbox-tree-ctx</code> component is a regular checkbox
      tree, built using signals and a context service (Angular v20).
    </p>
    <h4>Future enhancements</h4>
    <p>
      The tree is composed of two tags a parent
      <code>fl-form-checkbox-tree</code> and a child
      <code>fl-form-checkbox-tree-node</code>
    </p>
    <h4>Implementation Details</h4>
    <p>
      The tree is composed of two tags a parent
      <code>fl-form-checkbox-tree</code> and a child
      <code>fl-form-checkbox-tree-node</code>
    </p>
    <p>
      The parent tag will implement a custom form control having values of the
      type
      <code>number[]</code>
    </p>
    <p>
      Updating the states of the parent nodes is done via "registering" an entry
      into a <code>Map</code> implemented in the context service
    </p>
    <p>
      Updating the control value is done internally via a context property
      managed by the control context services. (note: not via signal changes)
    </p>
  </section>
  <button slot="tab">Api</button>
  <section slot="panel">
    <h3 class="mt-3 mb-6">Component api (tree node)</h3>
    <fl-doc-api [apiDocumentation]="apiDocumentation"></fl-doc-api>
  </section>
  <button slot="tab">Styling</button>
  <section slot="panel">
    <h3 class="mt-3 mb-6">Styling</h3>
    <p>As usual, with angular component/global styling</p>
  </section>
  <button slot="tab">Examples</button>
  <section slot="panel">
    <h3 class="mt-3 mb-6">Examples</h3>
    <fl-doc-example-card
      [exampleHtmlCode]="exampleHtmlCode"
      [exampleTsCode]="exampleTsCode"
      [exampleCssCode]="exampleCssCode"
    >
      <div class="p-4 flex gap-4 justify-between">
        <div>
          <div>
            <label for="opt">Select items via input:</label>
            <input
              type="text"
              id="opt"
              [formControl]="newValueControl"
              placeholder="Enter new value coma separated IDs"
            />
            <small
              >Update selected items by entering comma separated IDs in the
              input box</small
            >
          </div>
          <div class="pt-4">Selected item IDs: {{folderTreeControl.value}}</div>
        </div>
        <div class="tree-container">
          @if(data.isLoading()) {
          <div>Loading...</div>
          } @else {
          <fl-form-checkbox-tree-ctx
            [formControl]="folderTreeControl"
            class="mb-4"
          >
            @for (node of data.value(); track node.id) {
            <fl-form-checkbox-tree-node-ctx
              [node]="node"
            ></fl-form-checkbox-tree-node-ctx>
            }
          </fl-form-checkbox-tree-ctx>
          }
          <div class="flex justify-end">
            <button
              (click)="resetControl()"
              class="rounded bg-primary text-white p-2"
            >
              Clear selection
            </button>
          </div>
        </div>
      </div>
    </fl-doc-example-card>
  </section>
</fl-lion-tabs>
